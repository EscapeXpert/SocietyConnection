<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title><%= post.title %></title>
</head>
<body>
<a href="/board/<%= board.id %>"><%= board.name %></a>
<div>
    <% if(post.creator_id === user_id) { %>
        <a href="#" id="modify">수정</a>
        <a href="#" id="delete">삭제</a>
    <% } %>
</div>
<div>
    <!-- 프로필 사진-->
    <a href="/profile/<%= post.nickname %>"><%= post.nickname %></a>
    <p><%= post.grade %></p>
    <% if(post.creator_id !== user_id) { %>
        <a href='#'
           onclick="window.open('/message/write?target_nickname=<%= post.nickname %>','<%= post.nickname %>>', 'status=no, toolbar=no, menubar=no, width=400, height=300');return false">쪽지</a>
    <% } %>
</div>
<div>
    <div>
        <h3><%= post.title %></h3>
        <% const contents = post.content.split('\n') %>
        <% for(var content of contents) { %>
            <p><%= content %></p>
        <% } %>
    </div>
    <div>
        <a href="#" id="like">
            <% if(is_like == null) { %>
                <img src="/public/icon/red-empty-heart.svg" width="16" height="16" alt="">
            <% } else { %>
                <img src="/public/icon/red-heart.svg" width="16" height="16" alt="">
            <% } %>
        </a>
        <p>좋아요 <%= post.like %></p>
    </div>
    <div>
        <ul>
            <% for(var user of like_users) { %>
                <li>
                    <!-- 프로필 사진-->
                    <a href="/profile/<%= user.nickname %>"><%= user.nickname %></a>
                </li>
            <% } %>
        </ul>
    </div>
</div>
<input type="hidden" id="post_id" name="post_id" value="<%= post.id %>">
</body>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script>
    const like_tag = document.querySelector('#like');
    const post_id = document.querySelector('#post_id').value;
    like_tag.addEventListener('click', async function () {
        await axios.post(`/post/${post_id}/like`)
            .then((response) => {
                console.log(response)
                location.reload();
            })
            .catch((err) => {
                console.error(err);
            });
    });
</script>
</html>